# Local development override (auto-loaded with docker-compose.yml)
services:
  api:
    build:
      context: .
      target: dev
    image: kodekamper-api:dev
    ports:
      - '5001:5000'  # Avoid macOS ControlCenter conflict on port 5000
    env_file:
      - ./.env.docker  # Use Docker-specific env vars
    volumes:
      - .:/app
      - /app/node_modules
    depends_on:
      mongo:
        condition: service_healthy
      redis:
        condition: service_healthy

  mongo:
    ports:
      - '27017:27017'

  redis:
    ports:
      - '6379:6379'
